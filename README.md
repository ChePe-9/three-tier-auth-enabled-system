# Lab 1: Программный комплекс с трехуровневой архитектурой

## Описание проекта

Этот проект представляет собой программный комплекс, реализующий трехуровневую архитектуру (клиент-сервер-база данных). Он включает механизм авторизации пользователей, работу с базой данных PostgreSQL через ORM SQLAlchemy и взаимодействие через RESTful API.

## Функциональность

### Авторизация и регистрация пользователей:
- Пользователи могут регистрироваться через форму.
- Реализована безопасная авторизация с использованием JWT-токенов.

### Управление данными:
- CRUD-операции для категорий товаров.
- CRUD-операции для товаров, связанных с категориями.
- Создание заказов для авторизованных пользователей.
- Добавление товаров в заказы.

### Безопасность:
- Пароли хранятся в захешированном виде с использованием алгоритма `argon2`.
- Все запросы к защищенным маршрутам требуют JWT-токена.

### Интерфейс:
- Клиентская часть написана на HTML + JavaScript.
- Пользовательский интерфейс позволяет выполнять CRUD-операции через форму.

## Используемые технологии

### Backend
- **FastAPI**: Для создания серверной части и обработки HTTP-запросов.
- **SQLAlchemy**: ORM для работы с базой данных.
- **psycopg2**: Драйвер для подключения к PostgreSQL.
- **python-jose**: Для генерации и проверки JWT-токенов.
- **argon2-cffi**: Для безопасного хеширования паролей.

### Frontend
- **HTML**: Структура клиентской части.
- **JavaScript**: Логика взаимодействия с сервером через API.

### База данных
- **PostgreSQL**: Реляционная база данных для хранения данных пользователей, категорий, товаров, заказов и позиций заказа.

## Структура проекта

```plaintext
project/
│
├── app/ # Серверная часть
│   ├── main.py # Главный файл FastAPI
│   ├── models.py # Модели SQLAlchemy
│   ├── schemas.py # Pydantic модели для валидации данных
│   ├── crud.py # CRUD операции для работы с базой данных
│   └── database.py # Настройки подключения к базе данных
│
├── client/ # Клиентская часть
│   ├── index.html # Главная страница
│   └── script.js # JavaScript для взаимодействия с API
│
└── requirements.txt # Зависимости проекта
```
## Как запустить проект

1. **Установите зависимости**:
   ```bash
   pip install -r requirements.txt
   ```
2. **Создайте базу данных PostgreSQL:**:
   - Убедитесь, что PostgreSQL установлен.
   - Создайте новую базу данных и настройте строку подключения в .env:
   ```plaintext
   DATABASE_URL=postgresql://postgres:your_password@localhost/your_database_name?client_encoding=utf8
   ```
3. **Запустите сервер:**:
   ```bash
   uvicorn app.main:app --reload
   ```
4. **Откройте приложение в браузере**:
   ```plaintext
   http://127.0.0.1:8000/
   ```
## Особенности реализации

### Трехуровневая архитектура:
- **Клиентское приложение**: `index.html` + `script.js`.
- **Серверная часть**: FastAPI + SQLAlchemy.
- **База данных**: PostgreSQL.

### Безопасность:
- Хеширование паролей с помощью алгоритма `argon2` для защиты.
- Авторизация через JWT-токены для безопасного доступа к защищенным маршрутам.

### CRUD-операции:
- Проект работает с 5 таблицами:
  - **Пользователи (users)**: Хранит информацию о зарегистрированных пользователях.
  - **Категории (categories)**: Хранит категории товаров.
  - **Товары (products)**: Хранит товары, связанные с категориями.
  - **Заказы (orders)**: Хранит заказы, созданные пользователями.
  - **Позиции заказа (order_items)**: Хранит связи между заказами и товарами.

### Взаимодействие через API:
- Все данные обрабатываются через RESTful API.
- Клиентская часть использует JavaScript для отправки запросов.

## Пример использования

### Регистрация нового пользователя:
- Откройте форму регистрации и укажите имя пользователя и пароль.
- После успешной регистрации перейдите к форме авторизации.

### Авторизация:
- Введите имя пользователя и пароль для получения JWT-токена.
- При успешной авторизации откроется панель управления данными.

### CRUD-операции:
- Создание категорий, товаров, заказов и добавление товаров в заказы.
- Просмотр списка категорий, товаров, пользователей и заказов.

## Требования к системе

- **Python**: Версия 3.7 или выше.
- **PostgreSQL**: База данных должна быть доступна локально или удаленно.
- **Зависимости**: Установите все необходимые зависимости из файла `requirements.txt`.
## Зависимости
  ```plaintext
  fastapi==0.95.2
  uvicorn==0.23.2
  sqlalchemy==1.4.46
  psycopg2-binary==2.9.6
  argon2-cffi==21.3.0
  python-jose[cryptography]==3.3.0
  httpx==0.24.1
  ```
